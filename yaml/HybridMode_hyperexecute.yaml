---
version: 0.1
globalTimeout: 150
testSuiteTimeout: 150
testSuiteStep: 150

runson: ${matrix.os}
autosplit: true
maxRetries: 1
retryOnFailure: false
concurrency: 3


matrix:
  os: [ "win","linux"]
  #  os: [ "win", "mac
  browser: [ "Chrome", "Firefox"]
  parallelism: 3

env:
TARGET_OS: Windows 10

runtime:
  language: java
  version: 11

#Dependency caching for Windows
cachekey: '{{checksum "pom.xml"}}'
cacheDirectories:
  - .m2


# shell: bash

pre:
  #install playwright version to be used
  - npm install playwright@1.49.0 --save-exact
  #Download and install packages in the CACHE_DIR.
  #Skip Execution of the tests in the pre step
  - mvn -Dmaven.repo.local=./.m2 -Dmaven.test.skip=false clean install

report : true

mergeArtifacts: true

uploadArtefacts:
  - name: Surefire-Report
path:
  - target/surefire-reports/**

testDiscovery:
  type: raw
  mode: dynamic
  command: grep -rl '@ParameterizedTest' src/test/java/TestScenarios/*.java | awk -F'/' '{print substr($NF,1,length($NF)-5)}'

winTestRunnerCommand: mvn test `-Dplatname=win `-Dmaven.repo.local=./.m2 `-Dplatname=win dependency:resolve `-Dtest=$test surefire-report:report
linuxTestRunnerCommand: mvn test -Dplatname=linux -Dmaven.repo.local=./.m2 `-Dplatname=linux dependency:resolve -Dtest=$test surefire-report:report
#macTestRunnerCommand: mvn test -Dplatname=mac -Dmaven.repo.local=./.m2 `-Dplatname=mac dependency:resolve -Dtest=$test surefire-report:report


jobLabel: [playwright-Junit, hybrid]